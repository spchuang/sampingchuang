/*! videojs-markers - v0.4.0 - 2014-12-14
* Copyright (c) 2014 ; Licensed  */
"use strict";!function(a,b){function c(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}function d(b){function d(){p.sort(function(a,b){return a.time-b.time})}function f(b){var e=r.duration();a.each(b,function(b,d){d.position=d.time/e*100,d.key=c(),d.div=a("<div class='vjs-marker' data-marker-index='"+d.key+"'></div>"),d.div.css(n.markerStyle).css({"margin-left":-parseFloat(d.div.css("width"))/2+"px",left:d.position+"%"}),d["class"]&&d.div.addClass(d["class"]),d.text=d.text||"",d.overlayText=d.overlayText||"",q.find(".vjs-progress-control").append(d.div),o[d.key]=d,p.push(d),d.div.on("click",function(){var b=a(this).data("marker-index");r.currentTime(o[b].time)}),n.markerTip.display&&h(d.div)}),d()}function g(a){t&&(m=-1,t.css("visibility","hidden"));for(var b=0;b<a.length;b++){var c=a[b],e=p[c];e&&(delete o[e.key],p[c]=null,q.find(".vjs-marker[data-marker-index='"+e.key+"']").remove())}for(var b=p.length-1;b>=0;b--)null===p[b]&&p.splice(b,1);d()}function h(b){b.on("mouseover",function(){var b=a(this).data("marker-index");s.find(".vjs-tip-inner").text(n.markerTip.text(o[b])),s.css({left:o[b].position+"%","margin-left":-parseFloat(s.css("width"))/2-5+"px",visibility:"visible"})}).on("mouseout",function(){s.css("visibility","hidden")})}function i(){s=a("<div class='vjs-tip'><div class='vjs-tip-arrow'></div><div class='vjs-tip-inner'></div></div>"),q.find(".vjs-progress-control").append(s)}function j(){var c=r.currentTime();-1==m?a.each(o,function(a,d){return c>=d.time&&c<=d.time+n.breakOverlay.displayTime?(m=d.key,t.find(".vjs-break-overlay-text").text(n.breakOverlay.text(d)),t.css("visibility","visible"),b.onMarkerReached&&b.onMarkerReached(d),!1):void 0}):(c<o[m].time||c>o[m].time+n.breakOverlay.displayTime)&&(m=-1,t.css("visibility","hidden"))}function k(){t=a("<div class='vjs-break-overlay'><div class='vjs-break-overlay-text'></div></div>").css(n.breakOverlay.style),q.append(t),m=-1}function l(){n.markerTip.display&&i(),r.markers.removeAll(),f(b.markers),n.breakOverlay.display&&(k(),r.on("timeupdate",j))}var m,n=a.extend(!0,{},e,b),o={},p=[],q=a(this.el()),r=this,s=null,t=null;r.on("loadedmetadata",function(){l()}),r.markers={next:function(){for(var a=r.currentTime(),b=0;b<p.length;b++)if(p[b].time>a)return r.currentTime(p[b].time),!1},prev:function(){for(var a=r.currentTime(),b=p.length-1;b>=0;b--)if(p[b].time+.5<a)return r.currentTime(p[b].time),!1},add:function(a){f(a)},remove:function(a){g(a)},removeAll:function(){for(var a=[],b=0;b<p.length;b++)a.push(b);g(a)},reset:function(a){r.markers.removeAll(),f(a)},destroy:function(){r.markers.removeAll(),t.remove(),s.remove(),r.off("timeupdate",j),delete r.markers,delete r.getMarkers}}}var e={markerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{display:!0,text:function(a){return"Break: "+a.text}},breakOverlay:{display:!1,displayTime:3,text:function(a){return"Break overlay: "+a.overlayText},style:{width:"100%",height:"20%","background-color":"rgba(0,0,0,0.7)",color:"white","font-size":"17px"}},onMarkerReached:function(){},markers:[]};b.plugin("markers",d)}(jQuery,window.videojs);